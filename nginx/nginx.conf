# Nginx main process configuration
# We explicitly set a single worker process since this is a simple demo container
# Trade-off: Not optimized for production scalability, but sufficient for assignment
worker_processes 1;

events {
    # Maximum number of simultaneous connections per worker
    # Assumption: 1024 is more than enough for this local test environment
    worker_connections 1024;
}

http {

    # First server block – serves custom HTML
    # Design decision: Port 8080 is used for the "success" endpoint
    # Assumption: Running on non-privileged ports avoids root requirements
    server {
        listen 8080;
        server_name localhost;

        # Root directory for static files
        # Design decision: Using default /var/www/html location for simplicity
        root /var/www/html;
        index index.html;

        location / {
            # try_files ensures only existing files are served
            # If file is missing, return 404
            # Trade-off: Simple static file handling, no dynamic routing
            try_files $uri $uri/ =404;
        }
    }

    # Second server block – always returns an error response
    # Design decision: Port 8081 is dedicated to simulate a failing endpoint
    # This allows automated tests to validate error handling behavior
    server {
        listen 8081;
        server_name localhost;

        location / {
            # Always return HTTP 404 regardless of request
            # Assumption: 404 is a clear and standard client error for testing
            return 404;
        }
    }

        server {
        listen 443 ssl;
        server_name localhost;

        ssl_certificate     /etc/nginx/certs/server.crt;
        ssl_certificate_key /etc/nginx/certs/server.key;

        root /var/www/html;
        index index.html;

        location / {
            try_files $uri $uri/ =404;
        }
    }


}
